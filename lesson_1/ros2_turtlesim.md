```markdown
# Практический туториал по turtlesim в ROS 2 Humble

## Введение

### Что такое turtlesim?
**Turtlesim** — это легковесный графический симулятор, созданный специально для обучения основам ROS 2. Он имитирует простого робота-черепаху, который может перемещаться по двумерной плоскости и оставлять след. 

### Зачем нужен turtlesim?
- **Изучение базовых концепций ROS 2**: узлы, топики, сервисы
- **Практика работы с инструментами ROS 2**: `ros2`, `rqt`, `ros2cli`
- **Безопасное экспериментирование**: все действия происходят в симуляторе
- **Быстрый старт**: минимальные требования к установке

## Предварительные требования

### 1. Установленный ROS 2 Humble
Перед началом убедитесь, что ROS 2 Humble установлен и настроен на вашей системе:
```bash
source /opt/ros/humble/setup.bash
ros2 doctor
```

### 2. Проверка установки
Убедитесь, что базовые команды ROS 2 работают:
```bash
ros2 --version
```

## Установка turtlesim

### Шаг 1: Обновление пакетного менеджера
```bash
sudo apt update
```

### Шаг 2: Установка turtlesim
```bash
sudo apt install ros-humble-turtlesim
```

### Шаг 3: Проверка установки
```bash
# Проверка доступных исполняемых файлов
ros2 pkg executables turtlesim

# Ожидаемый вывод:
# turtlesim draw_square
# turtlesim mimic
# turtlesim turtle_teleop_key
# turtlesim turtlesim_node
```

## Базовый запуск turtlesim

### Шаг 1: Запуск симулятора
**Терминал 1** - инициализация и запуск:
```bash
# Инициализация окружения ROS 2
source /opt/ros/humble/setup.bash

# Запуск симулятора
ros2 run turtlesim turtlesim_node
```

**Что произошло:**
- Запущен узел `turtlesim_node` с уникальным именем
- Создана черепаха в случайной позиции
- Открылось графическое окно симулятора

### Шаг 2: Запуск управления
**Терминал 2** - управление черепахой:
```bash
# Инициализация окружения ROS 2
source /opt/ros/humble/setup.bash

# Запуск управления с клавиатуры
ros2 run turtlesim turtle_teleop_key
```

### Шаг 3: Управление черепахой
- **Стрелка вверх** - движение вперед
- **Стрелка вниз** - движение назад
- **Стрелка влево** - поворот налево
- **Стрелка вправо** - поворот направо

> **Важное замечание:** Черепаха движется дискретно - каждый раз при нажатии клавиши она перемещается на фиксированное расстояние и останавливается.

## Исследование системы turtlesim

### 1. Изучение активных узлов
```bash
# В Терминале 3 (новый терминал)
source /opt/ros/humble/setup.bash

# Список активных узлов
ros2 node list

# Ожидаемый вывод:
# /turtlesim
# /teleop_turtle
```

### 2. Изучение топиков
```bash
# Список всех активных топиков
ros2 topic list

# Более подробная информация
ros2 topic list -t

# Просмотр сообщений в реальном времени
ros2 topic echo /turtle1/cmd_vel
```

### 3. Визуализация графа системы
```bash
# Запуск инструмента визуализации
rqt_graph
```

## Работа с сервисами turtlesim

### 1. Список доступных сервисов
```bash
ros2 service list
```

### 2. Создание новой черепахи
```bash
# Создание второй черепахи
ros2 service call /spawn turtlesim/srv/Spawn "{x: 10.0, y: 10.0, theta: 1.57, name: 'turtle2'}"

# Параметры:
# x, y - координаты (от 0 до 11)
# theta - угол поворота (в радианах)
# name - уникальное имя черепахи
```

### 3. Управление внешним видом

#### Изменение цвета пера:
```bash
# Установка красного пера
ros2 service call /turtle1/set_pen turtlesim/srv/SetPen "{r: 255, g: 0, b: 0, width: 5}"

# Установка зеленого пера
ros2 service call /turtle1/set_pen turtlesim/srv/SetPen "{r: 0, g: 255, b: 0, width: 3}"
```

#### Изменение цвета фона:
```bash
ros2 service call /clear std_srvs/srv/Empty
ros2 service call /background_color turtlesim/srv/SetParameters "{
  parameters: [
    {name: 'background_r', value: {integer_value: 100}},
    {name: 'background_g', value: {integer_value: 150}},
    {name: 'background_b', value: {integer_value: 200}}
  ]
}"
```

### 4. Управление движением через сервисы
```bash
# Прямое управление движением
ros2 service call /turtle1/teleport_absolute turtlesim/srv/TeleportAbsolute "{x: 5.5, y: 5.5, theta: 0.0}"

# Относительное перемещение
ros2 service call /turtle1/teleport_relative turtlesim/srv/TeleportRelative "{linear: 2.0, angular: 1.57}"
```

## Продвинутые возможности

### 1. Использование rqt для управления
```bash
# Запуск rqt
rqt

# В rqt можно:
# 1. Выбрать Plugins -> Services -> Service Caller
# 2. Выбрать нужный сервис
# 3. Заполнить параметры
# 4. Вызвать сервис
```

### 2. Запись и воспроизведение топиков
```bash
# Запись топиков в файл
ros2 bag record /turtle1/cmd_vel

# Воспроизведение записанного
ros2 bag play <имя_файла>.db3
```

### 3. Использование actions
```bash
# Список доступных действий
ros2 action list

# Информация о действии
ros2 action info /turtle1/rotate_absolute
```

## Практические задания

### Задание 1: Рисование фигур
**Цель:** Нарисовать квадрат, используя только клавиатурное управление.

**Подсказки:**
1. Двигайтесь вперед определенное расстояние
2. Поверните на 90 градусов
3. Повторите 4 раза

### Задание 2: Управление несколькими черепахами
**Цель:** Создать двух черепах и управлять ими поочередно.

**Шаги:**
1. Создайте вторую черепаху
2. Изучите, какие топики создались для новой черепахи
3. Напишите скрипт для поочередного управления

### Задание 3: Автоматическое движение
**Цель:** Использовать сервисы для автоматического перемещения черепахи по заданному маршруту.

### Задание 4: Изменение параметров в реальном времени
**Цель:** Изменять цвет пера в зависимости от скорости движения.

## Отладка и устранение проблем

### 1. Черепаха не двигается
```bash
# Проверьте активные узлы
ros2 node list

# Проверьте, публикуются ли сообщения
ros2 topic echo /turtle1/cmd_vel
```

### 2. Ошибки при вызове сервисов
```bash
# Проверьте правильность формата сообщения
ros2 interface show turtlesim/srv/Spawn
```

### 3. Проблемы с графическим интерфейсом
```bash
# Проверьте переменную DISPLAY
echo $DISPLAY

# Перезапустите turtlesim
ros2 run turtlesim turtlesim_node --ros-args --remap __node:=new_turtlesim
```

## Заключение

### Что вы узнали:
1. **Основы ROS 2**: узлы, топики, сервисы
2. **Работа с инструментами**: `ros2`, `rqt`
3. **Управление роботом**: движение, изменение параметров
4. **Отладка системы**: мониторинг, диагностика проблем

### Следующие шаги:
1. Изучите создание собственных узлов ROS 2
2. Поработайте с более сложными симуляторами (Gazebo)
3. Начните программировать настоящих роботов

## Полезные ссылки
- [Официальная документация turtlesim](https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html)
- [Исходный код turtlesim](https://github.com/ros/ros_tutorials)
- [ROS 2 cheat sheet](https://docs.ros.org/en/humble/Contributing/Developer-Guide.html)

---

> **Совет:** Сохраните этот туториал и возвращайтесь к нему при изучении новых концепций ROS 2. Turtlesim — отличный полигон для экспериментов!
```

Это полный markdown-туториал по turtlesim, который можно сразу сохранить как `.md` файл. Он содержит:
1. Полную структуру с правильными заголовками
2. Все команды в блоках кода
3. Подробные объяснения каждого шага
4. Практические задания для закрепления материала
5. Раздел по устранению проблем

Файл готов к использованию в документации или учебных материалах.